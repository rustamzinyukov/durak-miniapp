#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import telebot
from telebot import types
import json

# –í–∞—à —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
BOT_TOKEN = "8315517112:AAFwwuGjMMPijtfBUePU_11hH0ijrFAn_V8"

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
bot = telebot.TeleBot(BOT_TOKEN)

# URL –≤–∞—à–µ–π –∏–≥—Ä—ã (–ø–æ–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π, –ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ GitHub Pages)
GAME_URL = "http://localhost:8000"

@bot.message_handler(commands=['start'])
def send_welcome(message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start"""
    markup = types.InlineKeyboardMarkup()
    
    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
    markup.add(types.InlineKeyboardButton(
        "üéÆ –ò–≥—Ä–∞—Ç—å –≤ –î—É—Ä–∞–∫", 
        web_app=types.WebAppInfo(url=GAME_URL)
    ))
    
    # –ö–Ω–æ–ø–∫–∞ –ø–æ–º–æ—â–∏
    markup.add(types.InlineKeyboardButton("‚ùì –ü–æ–º–æ—â—å", callback_data="help"))
    
    welcome_text = """
üéÆ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É '–î—É—Ä–∞–∫'!

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–æ—á–Ω–∞—è –∏–≥—Ä–∞ —Å –ò–ò –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–º.

üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
‚Ä¢ 3 —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è (Casino, Tavern, Underground)
‚Ä¢ –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ —Ñ–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞
‚Ä¢ –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚Ä¢ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ò–ò

–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É! üÉè
    """
    
    bot.reply_to(message, welcome_text, reply_markup=markup)

@bot.message_handler(commands=['help'])
def send_help(message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help"""
    help_text = """
üéÆ –ò–≥—Ä–∞ '–î—É—Ä–∞–∫' - –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–æ—á–Ω–∞—è –∏–≥—Ä–∞

üìã –ö–æ–º–∞–Ω–¥—ã:
/start - –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
/help - –ü–æ–º–æ—â—å
/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

üéØ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:
1. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É –¥–ª—è –∞—Ç–∞–∫–∏
2. –ó–∞—â–∏—â–∞–π—Ç–µ—Å—å –æ—Ç –∞—Ç–∞–∫ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
3. –°—Ç–∞—Ä–∞–π—Ç–µ—Å—å –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –≤—Å–µ—Ö –∫–∞—Ä—Ç
4. –ü–æ–±–µ–∂–¥–∞–µ—Ç —Ç–æ—Ç, –∫—Ç–æ –ø–µ—Ä–≤—ã–º –∏–∑–±–∞–≤–∏—Ç—Å—è –æ—Ç –∫–∞—Ä—Ç

üé® –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:
‚Ä¢ Casino - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
‚Ä¢ Tavern - –°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—ã–π —Å—Ç–∏–ª—å  
‚Ä¢ Underground - –ú—Ä–∞—á–Ω—ã–π —Å—Ç–∏–ª—å

üîä –ó–≤—É–∫–∏:
‚Ä¢ –ó–≤—É–∫–∏ –≤—ã–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è –∫–∞—Ä—Ç
‚Ä¢ –ó–≤—É–∫–∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –∫–∞—Ä—Ç
‚Ä¢ –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ –ø–æ —Ç–µ–º–∞–º

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä
‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥/–ø–æ—Ä–∞–∂–µ–Ω–∏–π
‚Ä¢ –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è –ø–æ–±–µ–¥
‚Ä¢ –õ—É—á—à–∞—è —Å–µ—Ä–∏—è –ø–æ–±–µ–¥

–£–¥–∞—á–∏ –≤ –∏–≥—Ä–µ! üçÄ
    """
    bot.reply_to(message, help_text)

@bot.message_handler(commands=['stats'])
def send_stats(message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /stats"""
    stats_text = """
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã

–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –∏–≥—Ä–µ.

üéØ –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–≥—Ä—É
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (üìä)
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–≤–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

üìà –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
‚Ä¢ –í—Å–µ–≥–æ –∏–≥—Ä
‚Ä¢ –ü–æ–±–µ–¥
‚Ä¢ –ü–æ—Ä–∞–∂–µ–Ω–∏–π
‚Ä¢ –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥
‚Ä¢ –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è
‚Ä¢ –õ—É—á—à–∞—è —Å–µ—Ä–∏—è

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏! üîÑ
    """
    bot.reply_to(message, stats_text)

@bot.callback_query_handler(func=lambda call: call.data == "help")
def handle_help_callback(call):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–º–æ—â–∏"""
    send_help(call.message)
    bot.answer_callback_query(call.id)

@bot.message_handler(func=lambda message: True)
def handle_all_messages(message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    bot.reply_to(message, "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã! üéÆ")

if __name__ == '__main__':
    print("ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!")
    print(f"üéÆ URL –∏–≥—Ä—ã: {GAME_URL}")
    print("üì± –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start")
    
    try:
        bot.polling(none_stop=True)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")


