# üîÑ –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üìä –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:
- **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** (Telegram Cloud Storage + localStorage) - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (PostgreSQL) - –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã

```
1. –ò–≥—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
   ‚Üì
2. –ë—ã—Å—Ç—Ä–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ Telegram Cloud Storage (100-200ms)
   ‚úÖ –ò–≥—Ä–æ–∫ —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Å–≤–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   ‚Üì
3. –í –§–û–ù–ï —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å —Å–µ—Ä–≤–µ—Ä–æ–º (1-2 —Å–µ–∫)
   ‚Üì
4. –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–µ–µ ‚Üí –æ–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
   ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
```

### –ü–æ—Å–ª–µ –∏–≥—Ä—ã

```
1. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ª–æ–∫–∞–ª—å–Ω–æ (Telegram Cloud)
   ‚Üì
2. –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   ‚Üì
3. –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
```

## üîß –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä
```javascript
if (serverGames > localGames) {
  // –°–µ—Ä–≤–µ—Ä –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ –∏–≥—Ä ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  updateLocalFromServer();
} else if (localGames > serverGames) {
  // –õ–æ–∫–∞–ª—å–Ω–æ –±–æ–ª—å—à–µ –∏–≥—Ä ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
  sendLocalToServer();
}
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
```javascript
if (serverGames === localGames) {
  if (serverUpdatedAt > localUpdatedAt) {
    // –°–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ–∑–∂–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    updateLocalFromServer();
  } else {
    // –õ–æ–∫–∞–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    sendLocalToServer();
  }
}
```

## üíæ –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö

### Telegram Cloud Storage (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ Telegram
- ‚úÖ –î–æ 1 MB –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### localStorage (–†–µ–∑–µ—Ä–≤)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ Telegram Cloud –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

### PostgreSQL (–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ)
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –ª—é–±—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- ‚úÖ –ë—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤

## üì± –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±—ã—á–Ω–∞—è –∏–≥—Ä–∞ –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
```
1. –ó–∞–≥—Ä—É–∑–∫–∞: –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (200ms)
2. –§–æ–Ω: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º (1-2s)
3. –ü–æ—Å–ª–µ –∏–≥—Ä—ã: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ + —Å–µ—Ä–≤–µ—Ä
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–≤–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Ç–µ–ª–µ—Ñ–æ–Ω + –ø–ª–∞–Ω—à–µ—Ç)
```
–¢–ï–õ–ï–§–û–ù:
1. –ò–≥—Ä–∞–µ—Ç 5 –∏–≥—Ä ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ + —Å–µ—Ä–≤–µ—Ä

–ü–õ–ê–ù–®–ï–¢:
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–≥—Ä—É ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ (0 –∏–≥—Ä)
2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞ (5 –∏–≥—Ä)
3. ‚úÖ –í–∏–¥–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ 5 –∏–≥—Ä
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º
```
1. –ë–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. –ò–≥—Ä–∞–µ—Ç 3 –∏–≥—Ä—ã ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
3. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ù–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
```
1. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ ‚Üí –ª–æ–∫–∞–ª—å–Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Ä–≤–µ—Ä ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞ ‚Üí –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏–≥—Ä–∞ (—Ä–µ–¥–∫–∏–π —Å–ª—É—á–∞–π)
```
–¢–ï–õ–ï–§–û–ù (–∏–≥—Ä–∞–µ—Ç –ø–µ—Ä–≤—ã–º):
1. –ò–≥—Ä–∞–µ—Ç ‚Üí 10 –∏–≥—Ä
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–ü–õ–ê–ù–®–ï–¢ (–∏–≥—Ä–∞–µ—Ç —á–µ—Ä–µ–∑ 30 —Å–µ–∫):
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ (9 –∏–≥—Ä - —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ)
2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ‚Üí –≤–∏–¥–∏—Ç 10 –∏–≥—Ä –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –¥–æ 10 –∏–≥—Ä
4. –ò–≥—Ä–∞–µ—Ç –µ—â–µ –æ–¥–Ω—É ‚Üí 11 –∏–≥—Ä
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä ‚Üí 11 –∏–≥—Ä
```

## üõ†Ô∏è –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

```javascript
// –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
window.showStats()

// –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
window.syncStats()

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
window.exportStats()

// –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
window.clearStats()
```

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

```
üîÑ Starting sync with server...
üì• Server stats received: {...}
üïê Local updated: 2025-10-10T12:00:00.000Z
üïê Server updated: 2025-10-10T11:55:00.000Z
üéÆ Local games: 10
üéÆ Server games: 9
‚¨ÜÔ∏è Local stats are newer, syncing to server...
‚úÖ Sync completed successfully
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: 100-200ms
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º**: 1-2s (–≤ —Ñ–æ–Ω–µ)
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏–≥—Ä—ã**: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞)

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ `telegram_user_id`
- ‚úÖ API –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –∏–≥—Ä—É
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã (fallback)

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

1. ‚ö° **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
2. üîÑ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
3. üíæ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è
4. üåê **–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
5. üìä **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤–∏–¥–∏—Ç –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
6. üéØ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ fallback

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```javascript
window.showStats()
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```javascript
// –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
https://durak-miniapp-production.up.railway.app/admin/admin.html
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```javascript
await window.syncStats()
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
```javascript
console.log('Last update:', state.playerStats.updated_at)
```

